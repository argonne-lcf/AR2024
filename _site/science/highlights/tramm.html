<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware | 2024 ALCF Annual Report</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this study, researchers led by Argonne National Laboratory examined the feasibility of performing continuous energy Monte Carlo (MC) particle transport on the Cerebras Wafter-Scale Engine 2 (WSE-2). The researchers ported a key kernel from the MC transport algorithm to the Cerebras Software Language (CSL) programming model and evaluated the performance of the kernel on the Cerebras WSE-2." />
<meta property="og:description" content="In this study, researchers led by Argonne National Laboratory examined the feasibility of performing continuous energy Monte Carlo (MC) particle transport on the Cerebras Wafter-Scale Engine 2 (WSE-2). The researchers ported a key kernel from the MC transport algorithm to the Cerebras Software Language (CSL) programming model and evaluated the performance of the kernel on the Cerebras WSE-2." />
<link rel="canonical" href="http://localhost:4000/science/highlights/tramm" />
<meta property="og:url" content="http://localhost:4000/science/highlights/tramm" />
<meta property="og:site_name" content="2024 ALCF Annual Report" />
<meta property="og:image" content="http://localhost:4000/tramm.jpg" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/tramm.jpg" />
<meta property="twitter:title" content="Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"In this study, researchers led by Argonne National Laboratory examined the feasibility of performing continuous energy Monte Carlo (MC) particle transport on the Cerebras Wafter-Scale Engine 2 (WSE-2). The researchers ported a key kernel from the MC transport algorithm to the Cerebras Software Language (CSL) programming model and evaluated the performance of the kernel on the Cerebras WSE-2.","headline":"Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware","image":"http://localhost:4000/tramm.jpg","url":"http://localhost:4000/science/highlights/tramm"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://use.typekit.net/vpa7ous.css">
  <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="2024 ALCF Annual Report" /><meta property="og:title" content="ALCF 2023 Annual Report" />
  <meta property="og:image" content="http://localhost:4000/assets/images/og-ar2023.jpg" />
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V7JP2R5JPH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V7JP2R5JPH');
</script>

    <body class="theme--white">
  <header class="header" role="banner">

  <div class="nav-wrapper">
    <div class="nav-desktop">

      <div class="masthead">
        <h1><a href="http://localhost:4000/index.html">ALCF Annual Report</a></h1>
      </div>


      <div class="nav">
        
          <h2>
            
              <a href="http://localhost:4000/year-in-review/directors-letter">Year in Review</a>
            
            <!-- <a href="http://localhost:4000/year-in-review/directors-letter">Year in Review</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/features">Features</a>
            
            <!-- <a href="http://localhost:4000/features">Features</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/community-and-outreach">Growing the HPC Community</a>
            
            <!-- <a href="http://localhost:4000/community-and-outreach">Growing the HPC Community</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/expertise-and-resources">Expertise and Resources</a>
            
            <!-- <a href="http://localhost:4000/expertise-and-resources">Expertise and Resources</a> -->
          </h2>
        
          <h2>
            
              <a class="current" href="http://localhost:4000/science">Science</a>
            
            <!-- <a href="http://localhost:4000/science">Science</a> -->
          </h2>
        
        <div class='search-trig' id='js-search-trig'>
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
        </div>

        <form class='searchbar' id='js-searchbar' action="http://localhost:4000/search.html" method="get">
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
          <input 
            aria-label="Search the annual report"
            autocomplete="off"
            inputmode="search"
            placeholder="Search"
            type="search"
            id="search-box" 
            name="query"
          >
          <div class='x-box' id='js-searchbar-close'>
            <svg class='x' fill="currentColor" viewBox="0 0 512 512">
              <g>
                <polygon points="512,59.076 452.922,0 256,196.922 59.076,0 0,59.076 196.922,256 0,452.922 59.076,512 256,315.076 452.922,512 512,452.922 315.076,256"/>
              </g>
            </svg>
          </div>
        </form>

      </div>

    </div>
  </div>


  <div class="nav-wrapper">
    <div class="nav-mobile">

      <div class="masthead">
        <h1><a href="http://localhost:4000/index.html">ALCF Annual Report</a></h1>
      </div>


      <div class="nav">
        <div class="js-drop menuitem-wrapper" id="toggle-menu" data-menu="menu">
          <h1>Menu <!--&nbsp;&blacktriangledown;--></h1> 
          <div id="menu" class="dropdown js-dropdown-hidden">

            <div class="nav-wrapper">
               

                <div class="chunk">
                  <h2>
                    <a href="/year-in-review/directors-letter" class="menuitem">
                      Year in Review
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/year-in-review/directors-letter">
                            Director&rsquo;s Letter
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/year-in-review">
                            ALCF Leadership
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/about-alcf">
                            About ALCF
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/about-alcf#2024-by-the-numbers">
                            2024 by the Numbers
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/features" class="menuitem">
                      Features
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/features/aurora">
                            Aurora Nears Full Deployment
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/aurora-performance-highlights">
                            Aurora Performance Highlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/nexus-iri">
                            Linking Experimental Facilities and Leadership Computing
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/alcf-ai-testbed">
                            ALCF Continues to Expand AI Testbed Systems Deployed for Open Science
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/ai-training">
                            Preparing a new generation of AI-ready researchers
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/community-and-outreach" class="menuitem">
                      Growing the HPC Community
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/community-and-outreach/industry">
                            Partnering with Industry
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/building-an-hpc-workforce">
                            Building an HPC Workforce
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/hpc-community-activities">
                            Shaping the Future of Supercomputing
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/user-training-activities">
                            Training ALCF Users
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/educational-outreach-activities">
                            Inspiring Students
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/expertise-and-resources" class="menuitem">
                      Expertise and Resources
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/expertise-and-resources/systems">
                            ALCF Systems
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/team">
                            ALCF Team
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/staff-spotlights">
                            Staff Spotlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/staff-news">
                            Staff News
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/science" class="menuitem">
                      Science
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/science/allocation-programs">
                            Allocation Programs
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/highlights">
                            2024 Science Highlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/projects">
                            2024 Award List
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/publications">
                            Publications
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
                
            </div>   
          </div>
        </div>
        <div class='search-trig' id='js-search-trig-mobile'>
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
        </div>
        <form class='searchbar' id='js-searchbar-mobile' action="http://localhost:4000/search.html" method="get">
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
          <input 
            aria-label="Search the annual report"
            autocomplete="off"
            inputmode="search"
            placeholder="Search"
            type="search"
            id="search-box" 
            name="query"
          >
          <div class='x-box' id='js-searchbar-close-mobile'>
            <svg class='x' fill="currentColor" viewBox="0 0 512 512">
              <g>
                <polygon points="512,59.076 452.922,0 256,196.922 59.076,0 0,59.076 196.922,256 0,452.922 59.076,512 256,315.076 452.922,512 512,452.922 315.076,256"/>
              </g>
            </svg>
          </div>
        </form>
      </div>

    </div>
  </div>

</header>




<nav class="sidenav">

  

    
    
    
    
  

    
    
    
    
  

    
    
    
    
  

    
    
    
    
  

    
      <h2>
        <a href="http://localhost:4000/science" class="menuitem">
          Science
        </a>
      </h2>

      
        <ul>
          
            <li>
              
                <a href="http://localhost:4000/science/allocation-programs">Allocation Programs</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/science/highlights">2024 Science Highlights</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/science/projects">2024 Award List</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/science/publications">Publications</a>
              
            </li>
          
        </ul>
      
    
    
    
    
  


</nav>

<main class="page-content layout-wrapper sci-highlight" aria-label="Content">

	<!-- 

TEXT, BREADCRUMBS

-------------------------------------------------------------------------------

available parameters:

* required

-------------------------------------------------------------------------------

-->

<div id="breadcrumbs">
 
<a href="http://localhost:4000/index">Home</a>

  
    / <a href="http://localhost:4000/science">Science</a>
  

  
    / <a href="http://localhost:4000/science/highlights">Highlights</a>
  

  
    / Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware
  

</div>
	
	<!-- 

TEXT, CATEGORIZATION

-------------------------------------------------------------------------------

available parameters:
* field
* sdl

* required

-------------------------------------------------------------------------------

-->





<div class="cat">

	<p>
		<span class="cat--field">Computer Science</span> | 

		
			<span class="cat--sdl">&#xe905;<span class="inactive">;&#xe903;</span>&#xe904;</span> Simulation, Learning
		
	</p>

</div>

	<h1 class="page-title">Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware</h1>

	
	<!-- 

TEXT, META

-------------------------------------------------------------------------------

available parameters:
* name-1
* value-1
- name-2
- value-2
- name-3
- value-3
- name-4
- value-4
- name-5
- value-5
- name-6
- value-6

* required

-------------------------------------------------------------------------------

-->

<div class="meta">

	<p class="meta--pair">
		<span class="meta--name">PI</span>: 
		<span class="meta--val">John Tramm, Argonne National Laboratory</span>
	</p>
	
	
		<p class="meta--pair">
			<span class="meta--name">AWARD</span>: 
			<span class="meta--val">Director’s Discretionary</span>
		</p>
	

	

	

	

	

</div>

	

	<!-- 

MEDIA, IMAGE
please use hero-page include for hero images

-------------------------------------------------------------------------------

available parameters:
* source
- caption
- credit

* required

-------------------------------------------------------------------------------

-->


<div class="media-img">
	<div class="img-wrapper">
		<div><img src="http://localhost:4000/assets/images/tramm.jpg"></div>
	</div>

	
		<small class="caption">
			Diagram showing the energy column sorting process. Each square represents a single PE in the WSE-2 grid, with each dot representing a particle.
			
				<span class="credit">Image: John Tramm, Kazutomo Yoshii, Andrew Siegel, Argonne National Laboratory; Bryce Allen, Argonne National Laboratory and University of Chicago; Leighton Wilson, Cerebras Systems</span>
			
		</small>
	
</div>


	<div class="primary-txt">
		<!-- 

TEXT, INTRO

-------------------------------------------------------------------------------

available parameters:
* blurb

* required

-------------------------------------------------------------------------------

-->

<p class="intro">In this study, researchers led by Argonne National Laboratory examined the feasibility of performing continuous energy Monte Carlo (MC) particle transport on the Cerebras Wafter-Scale Engine 2 (WSE-2). The researchers ported a key kernel from the MC transport algorithm to the Cerebras Software Language (CSL) programming model and evaluated the performance of the kernel on the Cerebras WSE-2.</p>

<h2 id="challenge">Challenge</h2>

<p>Beyond the challenge of porting the kernel into the low-level CSL programming model, the team proposed and tested various new algorithms to handle the decomposition of neutron cross-sectional data (which is used to generate random samples for particle behavior) into the small local memory domains contained in each of some 750,000 WSE-2 units.</p>

<h2 id="approach">Approach</h2>

<p>The researchers ported a simplified version of the MC cross-section lookup kernel (a kernel used by the MC neutral particle transport algorithm) using the Cerebras SDK and the Cerebras CSL programming model. Their decomposition and communication scheme involved three stages: (1) the sorting of particles into energy bands within each column of compute cores; (2) an iterative diffusion-based load balancing stage for balancing starting particle loads within each row; and (3) an exchange of particles to allow particles to accumulate nuclide information from each column in the row. All communication patterns had to be developed to avoid any concept of global synchronization or point-to-point message passing, given the limitations of the WSE-2 hardware. Additionally, the team developed an architecture-specific optimization to leverage the capabilities of the WSE-2 and a highly optimized CUDA kernel for testing on an NVIDIA A100 graphics processing unit to provide a baseline to contextualize the performance of the WSE-2.</p>

<h2 id="results">Results</h2>

<p>A single WSE-2 was found to run 130 times faster than the highly optimized CUDA version of the kernel deployed on a single NVIDIA A100—significantly outpacing expected performance increase, given the difference in transistor counts between the architectures. However, the performance gains came at a cost—namely, increases in both software programming and algorithmic complexity. Considering how AI accelerators such as the WSE-2 were designed almost exclusively around deep learning AI tasks, it is noteworthy that the WSE-2 is already able to exceed performance expectations relative to GPUs—an architecture that has had several decades to mature and is now quite friendly to HPC simulation applications. A follow-up study saw the WSE-2 achieve a 182x speedup over the A100.</p>

<h2 id="impact">Impact</h2>

<p>The team’s analysis suggests the potential for a wide variety of complex and irregular simulation methods to be mapped efficiently onto AI accelerators like the Cerebras WSE-2. Such accelerators could offer significant advantages to traditional simulation workloads, and the development of higher-level programming models to more readily enable software development and exploration could greatly benefit HPC simulations. MC simulations themselves offer the potential to fill in crucial gaps in experimental and operational nuclear reactor data.</p>

	</div>



	

	<!-- 

TEXT, PUBLICATION LIST

-------------------------------------------------------------------------------

available parameters:
* pubs

* required

-------------------------------------------------------------------------------

-->

<div class="pubs">
	<h3>PUBLICATIONS</h3>

	<ul>

		
			<li>
				
					<a href="https://doi.org/10.1016/j.cpc.2023.109072">
						<span class="authors">Tramm, J., B. Allen, K. Yoshii, A. Siegel, and L. Wilson. </span>
						<span class="title">&ldquo;Efficient Algorithms for Monte Carlo Particle Transport on AI Accelerator Hardware,&rdquo; </span>
						<span class="source"><i>Computer Physics Communications</i> </span>
						<span class="date">(December 2023), </span>
						<span class="publisher">Elsevier BV.</span>
					</a>
				
			</li>
		
			<li>
				
					<a href="https://doi.org/10.13182/PHYSOR24-43696">
						<span class="authors">Tramm, J., B. Allen, K. Yoshii, and A. Siegel. </span>
						<span class="title">&ldquo;Monte Carlo with Single-Cycle Latency: Optimization of a Continuous Energy Cross Section Lookup Kernel for AI Accelerator Hardware,&rdquo; </span>
						<span class="source"><i>International Conference on Physics of Reactors</i> </span>
						<span class="date">(April 2024), </span>
						<span class="publisher">American Nuclear Society.</span>
					</a>
				
			</li>
		

		

	</ul>

</div>


	

	<button class="to-top js-to-top">
		Back to Top &uarr;
	</button>

</main><footer>

	<div class="content-wrapper">


		<div class="alcf-logo">
			<img src="http://localhost:4000/assets/images/logo-h.png" />
		</div>

		<div class="alcf-info">
			<h2>CONTACT</h2>
			<p>
				<a href="mailto:media@alcf.anl.gov">media@alcf.anl.gov</a><br>
				<a href="https://alcf.anl.gov/">alcf.anl.gov</a>
			</p>
		</div>

		<div class="smallprint">
			<ul>
				<li><a href="http://localhost:4000/about">About</a></li>
				<li><a href="http://localhost:4000/disclaimer">Disclaimer</a></li>
				<li><a href="http://localhost:4000/credits">Credits</a></li>
			</ul>
		</div>




		<div class="bottom">
			<hr>

			<!-- <div class="llc">
				<img src="http://localhost:4000/assets/images/llc-logo.png" />
			</div> -->

			<div class="doe-info">
				<img class='llc' src="http://localhost:4000/assets/images/llc-logo.png" />
				<img class='doe' src="http://localhost:4000/assets/images/doe.png" />
				<p>Argonne National Laboratory is a U.S. Department of Energy laboratory<br>managed by UChicago Argonne, LLC.</p>
			</div>

		</div>
	
  </div>

  <script src="http://localhost:4000/assets/js/plugin--totop.js"></script>
  <script src="http://localhost:4000/assets/js/plugin--dropdown.js"></script>
  <script src="http://localhost:4000/assets/js/app.js"></script>

</footer>
</body>

</html>
