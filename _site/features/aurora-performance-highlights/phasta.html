<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Machine Learning-Guided Computational Fluid Dynamics at Extreme Scales | 2024 ALCF Annual Report</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Machine Learning-Guided Computational Fluid Dynamics at Extreme Scales" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This University of Colorado-led effort is aimed at developing a scalable framework to enable in-situ machine learning (ML) capabilities from exascale simulations, with the goal of using high-fidelity data from direct numerical simulations (DNS) of complex, wall-bounded turbulent flows to train accurate and generalizable sub-grid stress models for large eddy simulations (LES). The LES performed using the PHASTA application—with up to a billion degrees of freedom—will help elucidate the physics of flow separation at high Reynolds numbers, aiding the design of more aerodynamic and efficient aircraft.The project also aims to address I/O bottlenecks accentuated by the rise of exascale computing. Aurora enables simulations to be conducted at unprecedented scales, producing more data than ever before—but also producing bottlenecks via the traditional practice of saving the simulation data to disk. By performing ML model training concurrently with DNS, researchers can avoid the file system altogether and efficiently stream data between simulation and ML training modules, storing the necessary data in-memory on the compute nodes and ensuring the capture of all the simulation physics generated throughout the workflow." />
<meta property="og:description" content="This University of Colorado-led effort is aimed at developing a scalable framework to enable in-situ machine learning (ML) capabilities from exascale simulations, with the goal of using high-fidelity data from direct numerical simulations (DNS) of complex, wall-bounded turbulent flows to train accurate and generalizable sub-grid stress models for large eddy simulations (LES). The LES performed using the PHASTA application—with up to a billion degrees of freedom—will help elucidate the physics of flow separation at high Reynolds numbers, aiding the design of more aerodynamic and efficient aircraft.The project also aims to address I/O bottlenecks accentuated by the rise of exascale computing. Aurora enables simulations to be conducted at unprecedented scales, producing more data than ever before—but also producing bottlenecks via the traditional practice of saving the simulation data to disk. By performing ML model training concurrently with DNS, researchers can avoid the file system altogether and efficiently stream data between simulation and ML training modules, storing the necessary data in-memory on the compute nodes and ensuring the capture of all the simulation physics generated throughout the workflow." />
<link rel="canonical" href="http://localhost:4000/features/aurora-performance-highlights/phasta" />
<meta property="og:url" content="http://localhost:4000/features/aurora-performance-highlights/phasta" />
<meta property="og:site_name" content="2024 ALCF Annual Report" />
<meta property="og:image" content="http://localhost:4000/phasta.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/phasta.png" />
<meta property="twitter:title" content="Machine Learning-Guided Computational Fluid Dynamics at Extreme Scales" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"This University of Colorado-led effort is aimed at developing a scalable framework to enable in-situ machine learning (ML) capabilities from exascale simulations, with the goal of using high-fidelity data from direct numerical simulations (DNS) of complex, wall-bounded turbulent flows to train accurate and generalizable sub-grid stress models for large eddy simulations (LES). The LES performed using the PHASTA application—with up to a billion degrees of freedom—will help elucidate the physics of flow separation at high Reynolds numbers, aiding the design of more aerodynamic and efficient aircraft.The project also aims to address I/O bottlenecks accentuated by the rise of exascale computing. Aurora enables simulations to be conducted at unprecedented scales, producing more data than ever before—but also producing bottlenecks via the traditional practice of saving the simulation data to disk. By performing ML model training concurrently with DNS, researchers can avoid the file system altogether and efficiently stream data between simulation and ML training modules, storing the necessary data in-memory on the compute nodes and ensuring the capture of all the simulation physics generated throughout the workflow.","headline":"Machine Learning-Guided Computational Fluid Dynamics at Extreme Scales","image":"http://localhost:4000/phasta.png","url":"http://localhost:4000/features/aurora-performance-highlights/phasta"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://use.typekit.net/vpa7ous.css">
  <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="2024 ALCF Annual Report" /><meta property="og:title" content="ALCF 2024 Annual Report" />
  <meta property="og:image" content="http://localhost:4000/assets/images/og-ar2023.jpg" />
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V7JP2R5JPH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V7JP2R5JPH');
</script>

    <body class="theme--dark">
  <header class="header" role="banner">

  <div class="nav-wrapper">
    <div class="nav-desktop">

      <div class="masthead">
        <h1><a href="http://localhost:4000/index.html">ALCF Annual Report</a></h1>
      </div>


      <div class="nav">
        
          <h2>
            
              <a href="http://localhost:4000/year-in-review/directors-letter">Year in Review</a>
            
            <!-- <a href="http://localhost:4000/year-in-review/directors-letter">Year in Review</a> -->
          </h2>
        
          <h2>
            
              <a class="current" href="http://localhost:4000/features">Features</a>
            
            <!-- <a href="http://localhost:4000/features">Features</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/community-and-outreach">Growing the HPC Community</a>
            
            <!-- <a href="http://localhost:4000/community-and-outreach">Growing the HPC Community</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/expertise-and-resources">Expertise and Resources</a>
            
            <!-- <a href="http://localhost:4000/expertise-and-resources">Expertise and Resources</a> -->
          </h2>
        
          <h2>
            
              <a href="http://localhost:4000/science">Science</a>
            
            <!-- <a href="http://localhost:4000/science">Science</a> -->
          </h2>
        
        <div class='search-trig' id='js-search-trig'>
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
        </div>

        <form class='searchbar' id='js-searchbar' action="http://localhost:4000/search.html" method="get">
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
          <input 
            aria-label="Search the annual report"
            autocomplete="off"
            inputmode="search"
            placeholder="Search"
            type="search"
            id="search-box" 
            name="query"
          >
          <div class='x-box' id='js-searchbar-close'>
            <svg class='x' fill="currentColor" viewBox="0 0 512 512">
              <g>
                <polygon points="512,59.076 452.922,0 256,196.922 59.076,0 0,59.076 196.922,256 0,452.922 59.076,512 256,315.076 452.922,512 512,452.922 315.076,256"/>
              </g>
            </svg>
          </div>
        </form>

      </div>

    </div>
  </div>


  <div class="nav-wrapper">
    <div class="nav-mobile">

      <div class="masthead">
        <h1><a href="http://localhost:4000/index.html">ALCF Annual Report</a></h1>
      </div>


      <div class="nav">
        <div class="js-drop menuitem-wrapper" id="toggle-menu" data-menu="menu">
          <h1>Menu <!--&nbsp;&blacktriangledown;--></h1> 
          <div id="menu" class="dropdown js-dropdown-hidden">

            <div class="nav-wrapper">
               

                <div class="chunk">
                  <h2>
                    <a href="/year-in-review/directors-letter" class="menuitem">
                      Year in Review
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/year-in-review/directors-letter">
                            Director&rsquo;s Letter
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/year-in-review">
                            ALCF Leadership
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/about-alcf">
                            About ALCF
                          </a>
                        </li>
                      
                        <li>
                          <a href="/year-in-review/about-alcf#2024-by-the-numbers">
                            2024 by the Numbers
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/features" class="menuitem">
                      Features
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/features/aurora">
                            Aurora Nears Full Deployment
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/aurora-performance-highlights">
                            Aurora Performance Highlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/nexus-iri">
                            Linking Experimental Facilities and Leadership Computing
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/alcf-ai-testbed">
                            ALCF Continues to Expand AI Testbed Systems Deployed for Open Science
                          </a>
                        </li>
                      
                        <li>
                          <a href="/features/ai-training">
                            Preparing a New Generation of AI-Ready Researchers
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/community-and-outreach" class="menuitem">
                      Growing the HPC Community
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/community-and-outreach/industry">
                            Powering Breakthroughs for U.S. Industry
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/workforce">
                            Building the Computing Workforce of the Future
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/hpc-community-activities">
                            Shaping the Future of Supercomputing
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/user-training-activities">
                            Training ALCF Users
                          </a>
                        </li>
                      
                        <li>
                          <a href="/community-and-outreach/educational-outreach-activities">
                            Inspiring Students
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/expertise-and-resources" class="menuitem">
                      Expertise and Resources
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/expertise-and-resources/systems">
                            ALCF Systems
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/team">
                            ALCF Team
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/staff-spotlights">
                            Staff Spotlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/expertise-and-resources/staff-news">
                            Staff News
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
               

                <div class="chunk">
                  <h2>
                    <a href="/science" class="menuitem">
                      Science
                    </a>
                  </h2>

                  
                    <ul>
                      
                        <li>
                          <a href="/science/allocation-programs">
                            Allocation Programs
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/highlights">
                            2024 Science Highlights
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/projects">
                            2024 Award List
                          </a>
                        </li>
                      
                        <li>
                          <a href="/science/publications">
                            Publications
                          </a>
                        </li>
                      
                    </ul>
                   
                </div>
                
            </div>   
          </div>
        </div>
        <div class='search-trig' id='js-search-trig-mobile'>
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
        </div>
        <form class='searchbar' id='js-searchbar-mobile' action="http://localhost:4000/search.html" method="get">
          <svg class='mag' aria-hidden="true" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
            />
          </svg>
          <input 
            aria-label="Search the annual report"
            autocomplete="off"
            inputmode="search"
            placeholder="Search"
            type="search"
            id="search-box" 
            name="query"
          >
          <div class='x-box' id='js-searchbar-close-mobile'>
            <svg class='x' fill="currentColor" viewBox="0 0 512 512">
              <g>
                <polygon points="512,59.076 452.922,0 256,196.922 59.076,0 0,59.076 196.922,256 0,452.922 59.076,512 256,315.076 452.922,512 512,452.922 315.076,256"/>
              </g>
            </svg>
          </div>
        </form>
      </div>

    </div>
  </div>

</header>




<nav class="sidenav">

  

    
    
    
    
  

    
      <h2>
        <a href="http://localhost:4000/features" class="menuitem">
          Features
        </a>
      </h2>

      
        <ul>
          
            <li>
              
                <a href="http://localhost:4000/features/aurora">Aurora Nears Full Deployment</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/features/aurora-performance-highlights">Aurora Performance Highlights</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/features/nexus-iri">Linking Experimental Facilities and Leadership Computing</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/features/alcf-ai-testbed">ALCF Continues to Expand AI Testbed Systems Deployed for Open Science</a>
              
            </li>
          
            <li>
              
                <a href="http://localhost:4000/features/ai-training">Preparing a New Generation of AI-Ready Researchers</a>
              
            </li>
          
        </ul>
      
    
    
    
    
  

    
    
    
    
  

    
    
    
    
  

    
    
    
    
  


</nav>

<main class="page-content layout-wrapper sci-highlight" aria-label="Content">

	<!-- 

TEXT, BREADCRUMBS

-------------------------------------------------------------------------------

available parameters:

* required

-------------------------------------------------------------------------------

-->

<div id="breadcrumbs">
 
<a href="http://localhost:4000/index">Home</a>

  
    / <a href="http://localhost:4000/features">Features</a>
  

  
    / <a href="http://localhost:4000/features/aurora-performance-highlights">Aurora performance highlights</a>
  

  
    / Machine Learning-Guided Computational Fluid Dynamics at Extreme Scales
  

</div>
	
	<!-- 

TEXT, CATEGORIZATION

-------------------------------------------------------------------------------

available parameters:
* field
* sdl

* required

-------------------------------------------------------------------------------

-->





<div class="cat">

	<p>
		<span class="cat--field"></span> | 

		
	</p>

</div>

	<h1 class="page-title">Machine Learning-Guided Computational Fluid Dynamics at Extreme Scales</h1>

	
	<!-- 

TEXT, META

-------------------------------------------------------------------------------

available parameters:
* name-1
* value-1
- name-2
- value-2
- name-3
- value-3
- name-4
- value-4
- name-5
- value-5
- name-6
- value-6

* required

-------------------------------------------------------------------------------

-->

<div class="meta">

	<p class="meta--pair">
		<span class="meta--name">PI</span>: 
		<span class="meta--val">Kenneth Jansen, University of Colorado</span>
	</p>
	
	
		<p class="meta--pair">
			<span class="meta--name">AWARD</span>: 
			<span class="meta--val">Aurora Early Science Program, INCITE</span>
		</p>
	

	

	

	

	

</div>

	

	<!-- 

MEDIA, IMAGE
please use hero-page include for hero images

-------------------------------------------------------------------------------

available parameters:
* source
- caption
- credit

* required

-------------------------------------------------------------------------------

-->


<div class="media-img">
	<div class="img-wrapper">
		<div><img src="http://localhost:4000/assets/images/phasta.png"></div>
	</div>

	
</div>


	<div class="primary-txt">
		<!-- 

TEXT, INTRO

-------------------------------------------------------------------------------

available parameters:
* blurb

* required

-------------------------------------------------------------------------------

-->

<p class="intro">This University of Colorado-led effort is aimed at developing a scalable framework to enable in-situ machine learning (ML) capabilities from exascale simulations, with the goal of using high-fidelity data from direct numerical simulations (DNS) of complex, wall-bounded turbulent flows to train accurate and generalizable sub-grid stress models for large eddy simulations (LES). The LES performed using the PHASTA application—with up to a billion degrees of freedom—will help elucidate the physics of flow separation at high Reynolds numbers, aiding the design of more aerodynamic and efficient aircraft.<br /><br />The project also aims to address I/O bottlenecks accentuated by the rise of exascale computing. Aurora enables simulations to be conducted at unprecedented scales, producing more data than ever before—but also producing bottlenecks via the traditional practice of saving the simulation data to disk. By performing ML model training concurrently with DNS, researchers can avoid the file system altogether and efficiently stream data between simulation and ML training modules, storing the necessary data in-memory on the compute nodes and ensuring the capture of all the simulation physics generated throughout the workflow.</p>

<h2 id="challenge">Challenge</h2>
<p>A main challenge the developers faced was translating the legacy, FORTRAN-based PHASTA application code—optimized for central processing unit- (CPU-) powered computing systems—to run on exascale graphics processing unit- (GPU-) based architectures. PHASTA’s compilers and code structures did not readily lend themselves to GPUs, leading the developers to leverage the libCEED application library, developed under the aegis of the Exascale Computing Project. libCEED adds wrapper functions to architecture-agnostic codes for physical models such that the models can be run in a finite-element framework. libCEED minimizes global traffic through the GPU memory hierarchy, effectively boosting performance.</p>

<p>Enabling the online ML component required that the developers ensure the framework for carrying out large-scale, high-fidelity DNS alongside distributed ML training (as well as the periodic transfer of terabyte-scale training data) scale to thousands of nodes with minimal overhead. To this end, the development team leveraged the open-source library SmartSim, allowing them to decouple the data transfer between simulation and training by staging the data in a database deployed on the compute nodes. In this way, the rate of data production from the simulation is completely independent of the data consumption rate of the ML training, with neither component blocking the progress of the other. Additionally, the team spearheaded a co-located framework with SmartSim which places all components (simulation, training, and database) on the same set of nodes, sharing the available CPU and GPU resources. With this approach, all training data transfers between simulation and ML training are confined within a single node: even though both the simulation and distributed training span thousands of nodes, the framework is, in effect, made scalable.</p>

<h2 id="performance-results">Performance Results</h2>
<p>The development team has been able to run the PHASTA application on Aurora using as many as 4096 nodes; depending on the problem size, the team has achieved a desirable timestep on the order of 0.6 seconds.</p>

<p>Scaling on up to 1536 nodes, the total overhead generated by the computational fluid dyanmics (CFD) simulation and ML trainer has remained small—approximately 5 percent of runtime—and, importantly, effectively constant. These results have demonstrated that the framework is both performant and scalable.</p>

<!-- 

MEDIA, IMAGE
please use hero-page include for hero images

-------------------------------------------------------------------------------

available parameters:
* source
- caption
- credit

* required

-------------------------------------------------------------------------------

-->

<div class="media-img">
	<div class="img-wrapper">
		<div><img src="http://localhost:4000/assets/images/AR2024_Phasta-chart.png" /></div>
	</div>

	
		<small class="caption">
			Relative overhead of CFD simulation and ML trainer spent communicating data to and from the database as the PHASTA application is scaled from 1 to 1,536 nodes on Aurora
			
		</small>
	
</div>

<h2 id="impact">Impact</h2>
<p>Bringing PHASTA to Aurora has provided a scalable and performant solution to performing in-situ ML at exascale, thereby enabling researchers to access and utilize much richer datasets for training ML models using simulation-generated data. Additionally, accuracy and uncertainty quantification metrics obtained from the ongoing training inform the data-generation process within the simulation, which can help permit intelligent data sub-sampling techniques that train models on fewer data samples with reduced energy costs.</p>

<p>Performing high-resolution simulations of turbulent flows at high Reynolds numbers will help refine the turbulence models currently available. These models can in turn be used for improved design of aircraft and other mechanical systems.</p>


	</div>



	

	<button class="to-top js-to-top">
		Back to Top &uarr;
	</button>

</main><footer>

	<div class="content-wrapper">


		<div class="alcf-logo">
			<img src="http://localhost:4000/assets/images/logo-h.png" />
		</div>

		<div class="alcf-info">
			<h2>CONTACT</h2>
			<p>
				<a href="mailto:media@alcf.anl.gov">media@alcf.anl.gov</a><br>
				<a href="https://alcf.anl.gov/">alcf.anl.gov</a>
			</p>
		</div>

		<div class="smallprint">
			<ul>
				<li><a href="http://localhost:4000/about">About</a></li>
				<li><a href="http://localhost:4000/disclaimer">Disclaimer</a></li>
				<li><a href="http://localhost:4000/credits">Credits</a></li>
			</ul>
		</div>




		<div class="bottom">
			<hr>

			<!-- <div class="llc">
				<img src="http://localhost:4000/assets/images/llc-logo.png" />
			</div> -->

			<div class="doe-info">
				<img class='llc' src="http://localhost:4000/assets/images/llc-logo.png" />
				<img class='doe' src="http://localhost:4000/assets/images/doe.png" />
				<p>Argonne National Laboratory is a U.S. Department of Energy laboratory<br>managed by UChicago Argonne, LLC.</p>
			</div>

		</div>
	
  </div>

  <script src="http://localhost:4000/assets/js/plugin--totop.js"></script>
  <script src="http://localhost:4000/assets/js/plugin--dropdown.js"></script>
  <script src="http://localhost:4000/assets/js/app.js"></script>

</footer>
</body>

</html>
